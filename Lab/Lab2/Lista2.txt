--Zad2
SELECT YEAR(s.OrderDate) AS Rok, MONTH(s.OrderDate) AS Miesiac, COUNT(DISTINCT s.CustomerId) AS "Roczni klienci"
FROM Sales.SalesOrderHeader s
GROUP BY YEAR(s.OrderDate), MONTH(s.OrderDate)
ORDER BY 1, 2;

SELECT Rok, [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12]
FROM (
SELECT DISTINCT YEAR(s.OrderDate) AS Rok, MONTH(s.OrderDate) AS Miesiac, s.CustomerId AS "Roczni klienci"
FROM Sales.SalesOrderHeader s) AS summary
PIVOT(
COUNT("Roczni klienci") 
FOR Miesiac IN ([1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12])) AS P
ORDER BY 1;



--Zad3
SELECT p.FirstName + ' ' + p.LastName AS "Imie i nazwisko", YEAR(Sales.SalesOrderHeader.OrderDate), COUNT(Sales.SalesOrderHeader.SalesOrderID) AS "Liczba transakcji"
FROM Person.Person p
JOIN Sales.SalesPerson ON Sales.SalesPerson.BusinessEntityID = p.BusinessEntityID
JOIN Sales.SalesOrderHeader ON Sales.SalesOrderHeader.SalesPersonID = Sales.SalesPerson.BusinessEntityID
GROUP BY p.FirstName + ' ' + p.LastName, YEAR(Sales.SalesOrderHeader.OrderDate);


SELECT "Imie i nazwisko", [2011], [2012], [2013], [2014]
FROM (
SELECT p.FirstName + ' ' + p.LastName AS "Imie i nazwisko", YEAR(Sales.SalesOrderHeader.OrderDate) AS Rok, Sales.SalesOrderHeader.SalesOrderID AS "Liczba transakcji"
FROM Person.Person p
JOIN Sales.SalesPerson ON Sales.SalesPerson.BusinessEntityID = p.BusinessEntityID
JOIN Sales.SalesOrderHeader ON Sales.SalesOrderHeader.SalesPersonID = Sales.SalesPerson.BusinessEntityID) AS summary
PIVOT(
COUNT("Liczba transakcji")
FOR Rok IN ([2011], [2012], [2013], [2014])) AS P;


--Zad4

